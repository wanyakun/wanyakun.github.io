<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>浏览器 | 坤坤同学</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="关心你所关心的，与世界分享你的知识、经验和见闻">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.91675566.css" as="style"><link rel="preload" href="/assets/js/app.6375932f.js" as="script"><link rel="preload" href="/assets/js/4.24377c97.js" as="script"><link rel="preload" href="/assets/js/1.b2724231.js" as="script"><link rel="preload" href="/assets/js/55.80bef3c8.js" as="script"><link rel="preload" href="/assets/js/9.1417a78f.js" as="script"><link rel="prefetch" href="/assets/js/10.3ed9434f.js"><link rel="prefetch" href="/assets/js/100.cb989008.js"><link rel="prefetch" href="/assets/js/101.35a5ccae.js"><link rel="prefetch" href="/assets/js/102.89b9a8a4.js"><link rel="prefetch" href="/assets/js/103.59219fee.js"><link rel="prefetch" href="/assets/js/104.5bda2a39.js"><link rel="prefetch" href="/assets/js/105.f00b9566.js"><link rel="prefetch" href="/assets/js/106.43816362.js"><link rel="prefetch" href="/assets/js/11.a6693458.js"><link rel="prefetch" href="/assets/js/12.4f400ebc.js"><link rel="prefetch" href="/assets/js/13.f3df739e.js"><link rel="prefetch" href="/assets/js/14.98d4c51c.js"><link rel="prefetch" href="/assets/js/15.82ee5431.js"><link rel="prefetch" href="/assets/js/16.501b2bbb.js"><link rel="prefetch" href="/assets/js/17.6f30b859.js"><link rel="prefetch" href="/assets/js/18.e54ec9cc.js"><link rel="prefetch" href="/assets/js/19.f42cfb7f.js"><link rel="prefetch" href="/assets/js/20.0b301474.js"><link rel="prefetch" href="/assets/js/21.bf67ae68.js"><link rel="prefetch" href="/assets/js/22.7116101f.js"><link rel="prefetch" href="/assets/js/23.80c41d67.js"><link rel="prefetch" href="/assets/js/24.1f13edc3.js"><link rel="prefetch" href="/assets/js/25.bebc5721.js"><link rel="prefetch" href="/assets/js/26.fed5348c.js"><link rel="prefetch" href="/assets/js/27.875fdca1.js"><link rel="prefetch" href="/assets/js/28.5b59b539.js"><link rel="prefetch" href="/assets/js/29.4f42f0f5.js"><link rel="prefetch" href="/assets/js/30.8c56543c.js"><link rel="prefetch" href="/assets/js/31.0a8a1d80.js"><link rel="prefetch" href="/assets/js/32.9784b164.js"><link rel="prefetch" href="/assets/js/33.19cd87f7.js"><link rel="prefetch" href="/assets/js/34.91428d9b.js"><link rel="prefetch" href="/assets/js/35.64ffd4fb.js"><link rel="prefetch" href="/assets/js/36.0d6c16ae.js"><link rel="prefetch" href="/assets/js/37.6a88b68d.js"><link rel="prefetch" href="/assets/js/38.e58aa667.js"><link rel="prefetch" href="/assets/js/39.16ea68d6.js"><link rel="prefetch" href="/assets/js/40.1807a356.js"><link rel="prefetch" href="/assets/js/41.81511b72.js"><link rel="prefetch" href="/assets/js/42.915999df.js"><link rel="prefetch" href="/assets/js/43.48000630.js"><link rel="prefetch" href="/assets/js/44.e78f3e03.js"><link rel="prefetch" href="/assets/js/45.cf3f1259.js"><link rel="prefetch" href="/assets/js/46.0d726ab7.js"><link rel="prefetch" href="/assets/js/47.5dbb042b.js"><link rel="prefetch" href="/assets/js/48.8a3b175a.js"><link rel="prefetch" href="/assets/js/49.9b3a0e37.js"><link rel="prefetch" href="/assets/js/5.da3929a7.js"><link rel="prefetch" href="/assets/js/50.2cccd3f9.js"><link rel="prefetch" href="/assets/js/51.5e23435f.js"><link rel="prefetch" href="/assets/js/52.fa0365a7.js"><link rel="prefetch" href="/assets/js/53.de7dd92f.js"><link rel="prefetch" href="/assets/js/54.cac4b947.js"><link rel="prefetch" href="/assets/js/56.4814bd83.js"><link rel="prefetch" href="/assets/js/57.f6a74cc5.js"><link rel="prefetch" href="/assets/js/58.18a912a5.js"><link rel="prefetch" href="/assets/js/59.6520f7d1.js"><link rel="prefetch" href="/assets/js/6.e39f5ca0.js"><link rel="prefetch" href="/assets/js/60.e0db7dc0.js"><link rel="prefetch" href="/assets/js/61.6ba5e2ec.js"><link rel="prefetch" href="/assets/js/62.f439a077.js"><link rel="prefetch" href="/assets/js/63.8e96afef.js"><link rel="prefetch" href="/assets/js/64.52babae7.js"><link rel="prefetch" href="/assets/js/65.f0800308.js"><link rel="prefetch" href="/assets/js/66.9f7b68fc.js"><link rel="prefetch" href="/assets/js/67.9f8294e8.js"><link rel="prefetch" href="/assets/js/68.d3b51862.js"><link rel="prefetch" href="/assets/js/69.19dfe383.js"><link rel="prefetch" href="/assets/js/7.694cc372.js"><link rel="prefetch" href="/assets/js/70.b8a280bc.js"><link rel="prefetch" href="/assets/js/71.7b8524f9.js"><link rel="prefetch" href="/assets/js/72.ad5377af.js"><link rel="prefetch" href="/assets/js/73.0bedae6b.js"><link rel="prefetch" href="/assets/js/74.3e66b443.js"><link rel="prefetch" href="/assets/js/75.e7f6d1a3.js"><link rel="prefetch" href="/assets/js/76.8fb99eae.js"><link rel="prefetch" href="/assets/js/77.25d2e469.js"><link rel="prefetch" href="/assets/js/78.52acb3d4.js"><link rel="prefetch" href="/assets/js/79.31cb1d8b.js"><link rel="prefetch" href="/assets/js/8.762d7cfc.js"><link rel="prefetch" href="/assets/js/80.2610fe44.js"><link rel="prefetch" href="/assets/js/81.de10dcb9.js"><link rel="prefetch" href="/assets/js/82.329324a0.js"><link rel="prefetch" href="/assets/js/83.c4e2081e.js"><link rel="prefetch" href="/assets/js/84.b5e12eea.js"><link rel="prefetch" href="/assets/js/85.71f66dc5.js"><link rel="prefetch" href="/assets/js/86.8c083037.js"><link rel="prefetch" href="/assets/js/87.4a4fc641.js"><link rel="prefetch" href="/assets/js/88.f0e0d572.js"><link rel="prefetch" href="/assets/js/89.53848e6a.js"><link rel="prefetch" href="/assets/js/90.76db58aa.js"><link rel="prefetch" href="/assets/js/91.7d2f1218.js"><link rel="prefetch" href="/assets/js/92.eee99b8c.js"><link rel="prefetch" href="/assets/js/93.fd972e1d.js"><link rel="prefetch" href="/assets/js/94.90fb1c24.js"><link rel="prefetch" href="/assets/js/95.ff804603.js"><link rel="prefetch" href="/assets/js/96.fe18dde5.js"><link rel="prefetch" href="/assets/js/97.b4cfb684.js"><link rel="prefetch" href="/assets/js/98.330e8097.js"><link rel="prefetch" href="/assets/js/99.75be948b.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.254f7798.js">
    <link rel="stylesheet" href="/assets/css/0.styles.91675566.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-1156296a><div data-v-1156296a><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1156296a data-v-1156296a><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-4e82dffc data-v-1156296a data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>坤坤同学</h3> <p class="description" data-v-4e82dffc data-v-4e82dffc>关心你所关心的，与世界分享你的知识、经验和见闻</p> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>wanyakun</span>
            
          <span data-v-4e82dffc>2016 - </span>
          2022
        </a></span></div></div> <div class="hide" data-v-1156296a><header class="navbar" data-v-1156296a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/avatar.jpg" alt="坤坤同学" class="logo"> <span class="site-name">坤坤同学</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/iOS/" class="nav-link"><i class="undefined"></i>
  iOS
</a></li><li class="dropdown-item"><!----> <a href="/categories/3D/" class="nav-link"><i class="undefined"></i>
  3D
</a></li><li class="dropdown-item"><!----> <a href="/categories/Summary/" class="nav-link"><i class="undefined"></i>
  Summary
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/ios/" class="nav-link"><i class="iconfont reco-other"></i>
  iOS
</a></div><div class="nav-item"><a href="/front/" class="nav-link router-link-active"><i class="iconfont reco-npm"></i>
  前端
</a></div><div class="nav-item"><a href="/notes/" class="nav-link"><i class="iconfont reco-document"></i>
  Notes
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/wanyakun" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1156296a></div> <aside class="sidebar" data-v-1156296a><div class="personal-info-wrapper" data-v-828910c6 data-v-1156296a><img src="/avatar.jpg" alt="author-avatar" class="personal-img" data-v-828910c6> <h3 class="name" data-v-828910c6>
    wanyakun
  </h3> <div class="num" data-v-828910c6><div data-v-828910c6><h3 data-v-828910c6>36</h3> <h6 data-v-828910c6>Articles</h6></div> <div data-v-828910c6><h3 data-v-828910c6>3</h3> <h6 data-v-828910c6>Tags</h6></div></div> <ul class="social-links" data-v-828910c6></ul> <hr data-v-828910c6></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/iOS/" class="nav-link"><i class="undefined"></i>
  iOS
</a></li><li class="dropdown-item"><!----> <a href="/categories/3D/" class="nav-link"><i class="undefined"></i>
  3D
</a></li><li class="dropdown-item"><!----> <a href="/categories/Summary/" class="nav-link"><i class="undefined"></i>
  Summary
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/ios/" class="nav-link"><i class="iconfont reco-other"></i>
  iOS
</a></div><div class="nav-item"><a href="/front/" class="nav-link router-link-active"><i class="iconfont reco-npm"></i>
  前端
</a></div><div class="nav-item"><a href="/notes/" class="nav-link"><i class="iconfont reco-document"></i>
  Notes
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/wanyakun" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>浏览器</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front/explorer/after-url.html" class="sidebar-link">从输入URL到页面加载的全过程</a></li><li><a href="/front/explorer/browser.html" aria-current="page" class="active sidebar-link">浏览器</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue3</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-4e82dffc data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>浏览器</h3> <!----> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>wanyakun</span>
            
          <span data-v-4e82dffc>2016 - </span>
          2022
        </a></span></div></div> <div data-v-1156296a><main class="page"><section><div class="page-title"><h1 class="title">浏览器</h1> <div data-v-1ff7123e><i class="iconfont reco-account" data-v-1ff7123e><span data-v-1ff7123e>wanyakun</span></i> <i class="iconfont reco-date" data-v-1ff7123e><span data-v-1ff7123e>12/23/2022</span></i> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h2 id="功能"><a href="#功能" class="header-anchor">#</a> 功能</h2> <p>向服务器发出请求，在浏览器窗口中展示您选择的网络资源，包括HTML，图片，PDF等，资源的位置由 URI（统一资源标示符）指定。</p> <h2 id="结构"><a href="#结构" class="header-anchor">#</a> 结构</h2> <ul><li>用户界面：包括地址栏、前进/后退按钮、书签等</li> <li>浏览器引擎：在用户界面和渲染引擎之间传送指令</li> <li>渲染引擎：负责渲染请求的内容。如果请求的内容是 HTML，它就负责解析 HTML 和 CSS 内容，并将解析后的内容显示在屏幕上。</li> <li>网络：用于网络调用，比如 HTTP 请求</li> <li>用户界面后端：用于绘制基本的窗口小部件，比如组合框和窗口。其公开了与平台无关的通用接口，而在底层使用操作系统的用户界面方法。</li> <li>JavaScript解释器：用于解释和执行JavaScript代码</li> <li>数据存储：持久层，浏览器需要在硬盘上保存各种数据，例如 Cookie。新的 HTML 规范 (HTML5) 定义了“网络数据库”，这是一个完整（但是轻便）的浏览器内数据库</li></ul> <p><img src="/assets/img/front/explorer/browser.png" alt="browser"></p> <p>注意：Chrome 浏览器的每个标签页都分别对应一个渲染引擎实例。每个标签页都是一个独立的进程。</p> <h2 id="关键渲染路径"><a href="#关键渲染路径" class="header-anchor">#</a> 关键渲染路径</h2> <p>关键渲染路径(Critical Rendering Path)是浏览器将 HTML，CSS 和 JavaScript 转换为屏幕上的像素所经历的步骤序列。优化关键渲染路径可提高渲染性能。</p> <div class="vuepress-flowchart loading vue"><svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 30 30" class="vuepress-flowchart-loading-icon" style="enable-background:new 0 0 50 50;"><rect x="0" y="13" width="4" height="5"><animate attributeName="height" attributeType="XML" values="5;21;5" begin="0s" dur="0.6s" repeatCount="indefinite"></animate> <animate attributeName="y" attributeType="XML" values="13; 5; 13" begin="0s" dur="0.6s" repeatCount="indefinite"></animate></rect> <rect x="10" y="13" width="4" height="5"><animate attributeName="height" attributeType="XML" values="5;21;5" begin="0.15s" dur="0.6s" repeatCount="indefinite"></animate> <animate attributeName="y" attributeType="XML" values="13; 5; 13" begin="0.15s" dur="0.6s" repeatCount="indefinite"></animate></rect> <rect x="20" y="13" width="4" height="5"><animate attributeName="height" attributeType="XML" values="5;21;5" begin="0.3s" dur="0.6s" repeatCount="indefinite"></animate> <animate attributeName="y" attributeType="XML" values="13; 5; 13" begin="0.3s" dur="0.6s" repeatCount="indefinite"></animate></rect></svg></div><ul><li>在解析 HTML 时会创建 DOM，HTML 可以请求 JavaScript，而 JavaScript 反过来，又可以更改 DOM。HTML 包含或请求样式，依次来构建 CSSOM。</li> <li>浏览器引擎将两者结合起来以创建 Render Tree (渲染树)，</li> <li>Layout(布局)确定页面上所有内容的大小和位置，</li> <li>确定布局后，将像素 Paint (绘制)到屏幕上。</li></ul> <p>需要着重指出的是，这是一个渐进的过程。为达到更好的用户体验，渲染引擎会力求尽快将内容显示在屏幕上。它不必等到整个 HTML 文档解析完毕之后，就会开始构建渲染树和设置布局。在不断接收和处理来自网络的其余内容的同时，渲染引擎会将部分内容解析并显示出来</p> <p><img src="/assets/img/front/explorer/webkit.png" alt="webkit"></p> <p>优化关键渲染路径可以缩短首次渲染的时间。了解和优化关键渲染路径对于确保重排和重绘可以每秒 60 帧的速度进行</p> <h3 id="生成dom"><a href="#生成dom" class="header-anchor">#</a> 生成DOM</h3> <p>DOM 构建是增量的。</p> <div class="vuepress-flowchart loading vue"><svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 30 30" class="vuepress-flowchart-loading-icon" style="enable-background:new 0 0 50 50;"><rect x="0" y="13" width="4" height="5"><animate attributeName="height" attributeType="XML" values="5;21;5" begin="0s" dur="0.6s" repeatCount="indefinite"></animate> <animate attributeName="y" attributeType="XML" values="13; 5; 13" begin="0s" dur="0.6s" repeatCount="indefinite"></animate></rect> <rect x="10" y="13" width="4" height="5"><animate attributeName="height" attributeType="XML" values="5;21;5" begin="0.15s" dur="0.6s" repeatCount="indefinite"></animate> <animate attributeName="y" attributeType="XML" values="13; 5; 13" begin="0.15s" dur="0.6s" repeatCount="indefinite"></animate></rect> <rect x="20" y="13" width="4" height="5"><animate attributeName="height" attributeType="XML" values="5;21;5" begin="0.3s" dur="0.6s" repeatCount="indefinite"></animate> <animate attributeName="y" attributeType="XML" values="13; 5; 13" begin="0.3s" dur="0.6s" repeatCount="indefinite"></animate></rect></svg></div><p>单个 DOM 节点以 startTag token 开始，以 endTag token 结束。节点包含有关 HTML 元素的所有相关信息。该信息是使用 token 描述的。节点根据 token 层次结构连接到 DOM 树中。<br>
如果另一组 startTag 和 endTag token 位于一组 startTag 和 endTag 之间，则在节点内有一个节点，这就是我们定义 DOM 树层次结构的方式。</p> <p><img src="/assets/img/front/explorer/dom-tree.png" alt="dom-tree"></p> <blockquote><p>DOM Tree是如何构建的？</p> <ol><li>转码，浏览器将接收到二进制数据按照指定编码格式转化为HTML字符串</li> <li>生成Tokens，之后开始Parser，浏览器会将HTML字符串解析成Tokens</li> <li>构建Nodes，对Node添加特定的属性，通过指针确定Node的父，子，兄弟关系和所属treeScope</li> <li>生成DOM树，通过node包含的指针确定关系，构建出DOM树</li></ol></blockquote> <h3 id="生成cssom"><a href="#生成cssom" class="header-anchor">#</a> 生成CSSOM</h3> <p>浏览器解析 css 文件，生成 CSSOM。CSSOM 包含了页面所有的样式，也就是如何展示 DOM 的信息。<br>
CSSOM 跟 DOM 很像，但是不同。<br>
DOM 构造是增量的，CSSOM 却不是。CSS 是渲染阻塞的：浏览器会阻塞页面渲染直到它接收和执行了所有的 CSS。<br> <strong>CSS 是渲染阻塞是因为规则可以被覆盖，所以内容不能被渲染直到 CSSOM 的完成</strong>。</p> <p><img src="/assets/img/front/explorer/cssom.png" alt="cssom"></p> <h3 id="render-tree"><a href="#render-tree" class="header-anchor">#</a> Render Tree</h3> <p>渲染树(Render Tree)包括了内容和样式：DOM 和 CSSOM 树结合为渲染树。<br>
为了构造渲染树，浏览器检查每个节点，从 DOM 树的根节点开始，并且决定哪些 CSS 规则被添加。<br>
渲染树只包含了可见内容(body 里的部分)。<br>
Head(通常)不包含任何可见信息，因此不会被包含在渲染树种。如果有元素上有 display: none;，它本身和其后代都不会出现在渲染树中。</p> <p><img src="/assets/img/front/explorer/render-tree.png" alt="render-tree"></p> <h3 id="layout"><a href="#layout" class="header-anchor">#</a> Layout</h3> <p>一旦渲染树被构建，布局变成了可能。布局取决于屏幕的尺寸。布局这个步骤决定了在哪里和如何在页面上放置元素，决定了每个元素的宽和高，以及他们之间的相关性。<br>
**提示：**一个页面渲染在不同尺寸的屏幕上，比如渲染在移动端和 PC 端上，展示有差异，在前面的步骤都是不变的，只有在布局的时候才会根据屏幕尺寸进行差异化处理。</p> <p><img src="/assets/img/front/explorer/layout.png" alt="layout"></p> <h3 id="paint"><a href="#paint" class="header-anchor">#</a> Paint</h3> <p>最后一步是将像素绘制在屏幕上，栅格化所有元素，将元素转换为实际像素。<br>
一旦渲染树创建并且布局完成，像素就可以被绘制在屏幕上。加载时，整个屏幕被绘制出来。之后，只有受影响的屏幕区域会被重绘，浏览器被优化为只重绘需要绘制的最小区域。<br>
绘制时间取决于何种类型的更新被附加在渲染树上。绘制是一个非常快的过程，所以聚焦在提升性能时这大概不是最有效的部分。</p> <p><img src="/assets/img/front/explorer/paint.png" alt="paint"></p> <h2 id="重排-reflow-和重绘-repaint"><a href="#重排-reflow-和重绘-repaint" class="header-anchor">#</a> 重排(Reflow)和重绘(Repaint)</h2> <p>重排(Reflow)：元素的 位置发生变动 时发生重排，也叫回流。此时在 Layout 阶段，计算每一个元素在设备视口内的确切位置和大小。当一个元素位置发生变化时，其父元素及其后边的元素位置都可能发生变化，代价极高。<br>
在回答什么是重排的时候，关键不是位置发生变动，这只是原因(Why)，而不是 What。What 是重新计算每个元素在设备视口内的确切位置和大小。</p> <p>重绘(Repaint): 元素的 样式发生变动 ，但是位置没有改变。此时在关键渲染路径中的 Paint 阶段，将渲染树中的每个节点转换成屏幕上的实际像素，这一步通常称为绘制或栅格化。<br>
而回答什么是重绘的关键点在于在关键渲染路径中的 Paint 阶段，将渲染树中的每个节点转换成屏幕上的实际像素，这才是 What。</p> <h2 id="javascript-与关键路径渲染"><a href="#javascript-与关键路径渲染" class="header-anchor">#</a> JavaScript 与关键路径渲染</h2> <p><img src="/assets/img/front/explorer/webkit.png" alt="webkit"></p> <p>从图中可以看到JavaScript 的执行是在生成渲染树之前的。这也是为什么 JavaScript 的加载、解析与执行会阻塞 DOM 的构建，阻塞页面的渲染。<br>
这其实是非常合理的<br>
因为 JavaScript 可以修改网页的内容，它可以更改 DOM，如果不阻塞，那么这边在构建 DOM，那边 JavaScript 在改 DOM，如何保障最终得到的 DOM 是否正确?<br>
而且在 JS 中前一秒获取到的 DOM 和后一秒获取到的 DOM 不一样是什么鬼?它会产生一系列问题，所以 JS 是阻塞的，它会阻塞 DOM 的构建流程，所以在 JS 中无法获取 JS 后面的元素，因为 DOM 还没构建到那。<br>
这就是为什么我们需要把 js 放在页面底部的原因，尽量保证 DOM 树生成完毕再去加载 JS，从而出现这样的效果。</p> <p><img src="/assets/img/front/explorer/optimized-rendering.png" alt="optimized-rendering"></p> <h2 id="性能优化"><a href="#性能优化" class="header-anchor">#</a> 性能优化</h2> <p>基于以上的分析，简单的性能优化的方式如下：</p> <ul><li>减少 DOM 树渲染时间(譬如降低 HTML 层级、标签尽量语义化等等)。</li> <li>减少 CSSOM 树渲染时间(降低选择器层级等等)。</li> <li>减少 HTTP 请求次数及请求大小。</li> <li>将 css 放在页面开始位置。</li> <li>将 js 放在页面底部位置，并尽可能用 defer 或者 async 避免阻塞的 js 加载，确保 DOM 树生成完才会去加载 JS。</li> <li>用 link 替代@import。</li> <li>如果页面 css 较少，尽量使用内嵌式。</li> <li>为了减少白屏时间，页面加载时先快速生成一个 DOM 树。</li></ul> <h3 id="正确的性能优化思路"><a href="#正确的性能优化思路" class="header-anchor">#</a> 正确的性能优化思路</h3> <p>当你遇到一个性能问题的时候，绝对不是去网上找一些性能优化的方法，然后不管三七二十一，就整上去，这样大概率是没啥用的。
<strong>第一件事情，一定是要先分析性能的瓶颈在哪里。</strong></p> <p>比如你遇到了首屏加载的性能问题，你就要根据开发者工具，比如看 network 是否是由于资源体积太大导致请求慢，还是后端处理慢，还是资源太多了加载慢。<br>
如果这些都不是，可能是因为 渲染慢，再去分析 performce 面板，看一下是 js 执行慢，还是啥原因。<br>
再比如你遇到了 webpack 的性能问题，比如打包的资源太大了，你要去解决这个问题，你也不应该直接去随便找几个优化的方法就开始整。而是先应该通过 webpack-bundle-analyzer 插件去分析包大的原因是什么?</p> <ul><li>是依赖包太大了，没有做按需加载?</li> <li>还是重复的打包了几个版本的相同依赖?</li> <li>还是因为 src 太大了，是否需要做个动态加载?</li> <li>还是因为其他的，通过 webpack-bundle-analyzer 分析出来的组成内容去找问题。</li></ul> <p>遇到问题应该先通过各种分析工具，找到出现性能瓶颈的原因，再根据这个原因去寻找对应的优化方式，要对症下药。</p> <h2 id="回答如何理解重排和重绘"><a href="#回答如何理解重排和重绘" class="header-anchor">#</a> 回答如何理解重排和重绘?</h2> <p>重排和重绘是浏览器关键渲染路径上的两个节点， 浏览器的关键渲染路径就是 DOM 和 CSSOM 生成渲染树，然后根据渲染树通过一个布局(也叫 layout)步骤来确定页面上所有内容的大小和位置，确定布局后，将像素 绘制 (也叫 Paint)到屏幕上。</p> <p>其中重排就是当元素的位置发生变动的时候，浏览器重新执行布局这个步骤，来重新确定页面上内容的大小和位置，确定完之后就会进行重新绘制到屏幕上，所以重排一定会导致重绘。</p> <p>如果元素位置没有发生变动，仅仅只是样式发生变动，这个时候浏览器重新渲染的时候会跳过布局步骤，直接进入绘制步骤，这就是重绘，所以重绘不一定会导致重排。</p> <h3 id="什么情况下触发"><a href="#什么情况下触发" class="header-anchor">#</a> 什么情况下触发</h3> <p>任何改变用来构建渲染树的信息都会导致一次重排或重绘</p> <ol><li>添加、删除、更新DOM节点</li> <li>通过display：none隐藏一个DOM节点 - 触发重绘和重排</li> <li>通过visibility：hidden隐藏一个DOM节点- 只会触发重绘，因为没有几何变化</li> <li>移动或者给页面中的DOM节点添加动画</li> <li>添加样式表，调整样式属性</li> <li>用户行为，例如调整窗口大小，改变字号，或者滚动</li></ol> <h3 id="如何避免"><a href="#如何避免" class="header-anchor">#</a> 如何避免</h3> <ol><li>集中改变样式，不要一条一条的修改DOM的样式</li> <li>不要把DOM节点的属性值放到循环里当做循环变量</li> <li>为动画的HTML元件，使用fixed或absoult的position，修改css时不会reflow</li> <li>不使用table布局，可能很小的一个改动就构成整个table的重新布局</li> <li>尽量只修改position:absoult或fixed的元素，对其他元素不影响</li> <li>动画开启GPU加速，translate使用3d变化</li> <li>提升为合成层
<ul><li>合成层的位图会交给GPU处理，比CPU速度快</li> <li>当重绘时只重绘本身，不会影响其他层</li> <li>对transform和opacity效果，不会触发layout和paint</li> <li>提升合成层的最好方式是使用css的will-change属性： will-change: transform;</li></ul></li></ol></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">12/24/2022, 7:23:45 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/front/explorer/after-url.html" class="prev">
            从输入URL到页面加载的全过程
          </a></span> <span class="next"><a href="/front/css/box.html">
            盒子模型
          </a></span></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-70334359><li class="level-2" data-v-70334359><a href="/front/explorer/browser.html#功能" class="sidebar-link reco-side-功能" data-v-70334359>功能</a></li><li class="level-2" data-v-70334359><a href="/front/explorer/browser.html#结构" class="sidebar-link reco-side-结构" data-v-70334359>结构</a></li><li class="level-2" data-v-70334359><a href="/front/explorer/browser.html#关键渲染路径" class="sidebar-link reco-side-关键渲染路径" data-v-70334359>关键渲染路径</a></li><li class="level-3" data-v-70334359><a href="/front/explorer/browser.html#生成dom" class="sidebar-link reco-side-生成dom" data-v-70334359>生成DOM</a></li><li class="level-3" data-v-70334359><a href="/front/explorer/browser.html#生成cssom" class="sidebar-link reco-side-生成cssom" data-v-70334359>生成CSSOM</a></li><li class="level-3" data-v-70334359><a href="/front/explorer/browser.html#render-tree" class="sidebar-link reco-side-render-tree" data-v-70334359>Render Tree</a></li><li class="level-3" data-v-70334359><a href="/front/explorer/browser.html#layout" class="sidebar-link reco-side-layout" data-v-70334359>Layout</a></li><li class="level-3" data-v-70334359><a href="/front/explorer/browser.html#paint" class="sidebar-link reco-side-paint" data-v-70334359>Paint</a></li><li class="level-2" data-v-70334359><a href="/front/explorer/browser.html#重排-reflow-和重绘-repaint" class="sidebar-link reco-side-重排-reflow-和重绘-repaint" data-v-70334359>重排(Reflow)和重绘(Repaint)</a></li><li class="level-2" data-v-70334359><a href="/front/explorer/browser.html#javascript-与关键路径渲染" class="sidebar-link reco-side-javascript-与关键路径渲染" data-v-70334359>JavaScript 与关键路径渲染</a></li><li class="level-2" data-v-70334359><a href="/front/explorer/browser.html#性能优化" class="sidebar-link reco-side-性能优化" data-v-70334359>性能优化</a></li><li class="level-3" data-v-70334359><a href="/front/explorer/browser.html#正确的性能优化思路" class="sidebar-link reco-side-正确的性能优化思路" data-v-70334359>正确的性能优化思路</a></li><li class="level-2" data-v-70334359><a href="/front/explorer/browser.html#回答如何理解重排和重绘" class="sidebar-link reco-side-回答如何理解重排和重绘" data-v-70334359>回答如何理解重排和重绘?</a></li><li class="level-3" data-v-70334359><a href="/front/explorer/browser.html#什么情况下触发" class="sidebar-link reco-side-什么情况下触发" data-v-70334359>什么情况下触发</a></li><li class="level-3" data-v-70334359><a href="/front/explorer/browser.html#如何避免" class="sidebar-link reco-side-如何避免" data-v-70334359>如何避免</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><!----></div></div>
    <script src="/assets/js/app.6375932f.js" defer></script><script src="/assets/js/4.24377c97.js" defer></script><script src="/assets/js/1.b2724231.js" defer></script><script src="/assets/js/55.80bef3c8.js" defer></script><script src="/assets/js/9.1417a78f.js" defer></script>
  </body>
</html>
