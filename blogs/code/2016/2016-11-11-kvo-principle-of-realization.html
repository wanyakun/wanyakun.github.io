<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>KVO实现原理 | 坤坤同学</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="关心你所关心的，与世界分享你的知识、经验和见闻">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.994e4abf.css" as="style"><link rel="preload" href="/assets/js/app.84ca5ab8.js" as="script"><link rel="preload" href="/assets/js/3.45fd2d9d.js" as="script"><link rel="preload" href="/assets/js/1.5fe79815.js" as="script"><link rel="preload" href="/assets/js/26.acba0af1.js" as="script"><link rel="preload" href="/assets/js/8.f448fe9c.js" as="script"><link rel="prefetch" href="/assets/js/10.2f9f2a33.js"><link rel="prefetch" href="/assets/js/11.e5031348.js"><link rel="prefetch" href="/assets/js/12.a25d59b7.js"><link rel="prefetch" href="/assets/js/13.b0e578ec.js"><link rel="prefetch" href="/assets/js/14.f0d71146.js"><link rel="prefetch" href="/assets/js/15.599a70f4.js"><link rel="prefetch" href="/assets/js/16.089ea69a.js"><link rel="prefetch" href="/assets/js/17.8bc9b687.js"><link rel="prefetch" href="/assets/js/18.35acc15c.js"><link rel="prefetch" href="/assets/js/19.ddc7dc7c.js"><link rel="prefetch" href="/assets/js/20.db1e89c6.js"><link rel="prefetch" href="/assets/js/21.16f48892.js"><link rel="prefetch" href="/assets/js/22.e91049d4.js"><link rel="prefetch" href="/assets/js/23.456a398a.js"><link rel="prefetch" href="/assets/js/24.1a61690a.js"><link rel="prefetch" href="/assets/js/25.80074885.js"><link rel="prefetch" href="/assets/js/27.222b2570.js"><link rel="prefetch" href="/assets/js/28.4fd99388.js"><link rel="prefetch" href="/assets/js/29.87cfeeee.js"><link rel="prefetch" href="/assets/js/30.6f41f354.js"><link rel="prefetch" href="/assets/js/31.9ecfcb81.js"><link rel="prefetch" href="/assets/js/32.ded9a273.js"><link rel="prefetch" href="/assets/js/33.f303fb56.js"><link rel="prefetch" href="/assets/js/34.cf29da5f.js"><link rel="prefetch" href="/assets/js/35.43ee87df.js"><link rel="prefetch" href="/assets/js/36.bb066824.js"><link rel="prefetch" href="/assets/js/37.e17009ac.js"><link rel="prefetch" href="/assets/js/38.b2ecd417.js"><link rel="prefetch" href="/assets/js/39.f136eb4d.js"><link rel="prefetch" href="/assets/js/4.2289047a.js"><link rel="prefetch" href="/assets/js/40.2053dd48.js"><link rel="prefetch" href="/assets/js/41.a1acb677.js"><link rel="prefetch" href="/assets/js/42.471f509c.js"><link rel="prefetch" href="/assets/js/43.a875f563.js"><link rel="prefetch" href="/assets/js/44.682dd723.js"><link rel="prefetch" href="/assets/js/45.b8c86210.js"><link rel="prefetch" href="/assets/js/46.bd554706.js"><link rel="prefetch" href="/assets/js/47.9b02731c.js"><link rel="prefetch" href="/assets/js/48.e8c39ed8.js"><link rel="prefetch" href="/assets/js/49.1c8c3e7f.js"><link rel="prefetch" href="/assets/js/5.39230002.js"><link rel="prefetch" href="/assets/js/50.5d839ca6.js"><link rel="prefetch" href="/assets/js/51.a13e5d35.js"><link rel="prefetch" href="/assets/js/52.bc5ac9ed.js"><link rel="prefetch" href="/assets/js/53.106b3740.js"><link rel="prefetch" href="/assets/js/54.e7e3f086.js"><link rel="prefetch" href="/assets/js/55.21c300df.js"><link rel="prefetch" href="/assets/js/56.341eb103.js"><link rel="prefetch" href="/assets/js/57.bee2f2d8.js"><link rel="prefetch" href="/assets/js/6.e5e5a94b.js"><link rel="prefetch" href="/assets/js/7.09f5704b.js"><link rel="prefetch" href="/assets/js/9.e6da8299.js">
    <link rel="stylesheet" href="/assets/css/0.styles.994e4abf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-1156296a><div data-v-1156296a><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1156296a data-v-1156296a><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-4e82dffc data-v-1156296a data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>坤坤同学</h3> <p class="description" data-v-4e82dffc data-v-4e82dffc>关心你所关心的，与世界分享你的知识、经验和见闻</p> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>wanyakun</span>
            
          <span data-v-4e82dffc>2016 - </span>
          2021
        </a></span></div></div> <div class="hide" data-v-1156296a><header class="navbar" data-v-1156296a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/avatar.jpg" alt="坤坤同学" class="logo"> <span class="site-name">坤坤同学</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/iOS/" class="nav-link"><i class="undefined"></i>
  iOS
</a></li><li class="dropdown-item"><!----> <a href="/categories/年终总结/" class="nav-link"><i class="undefined"></i>
  年终总结
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/ios/" class="nav-link"><i class="iconfont reco-other"></i>
  iOS
</a></div><div class="nav-item"><a href="/notes/" class="nav-link"><i class="iconfont reco-document"></i>
  Notes
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/wanyakun" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1156296a></div> <aside class="sidebar" data-v-1156296a><div class="personal-info-wrapper" data-v-828910c6 data-v-1156296a><img src="/avatar.jpg" alt="author-avatar" class="personal-img" data-v-828910c6> <h3 class="name" data-v-828910c6>
    wanyakun
  </h3> <div class="num" data-v-828910c6><div data-v-828910c6><h3 data-v-828910c6>34</h3> <h6 data-v-828910c6>Articles</h6></div> <div data-v-828910c6><h3 data-v-828910c6>2</h3> <h6 data-v-828910c6>Tags</h6></div></div> <ul class="social-links" data-v-828910c6></ul> <hr data-v-828910c6></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/iOS/" class="nav-link"><i class="undefined"></i>
  iOS
</a></li><li class="dropdown-item"><!----> <a href="/categories/年终总结/" class="nav-link"><i class="undefined"></i>
  年终总结
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/ios/" class="nav-link"><i class="iconfont reco-other"></i>
  iOS
</a></div><div class="nav-item"><a href="/notes/" class="nav-link"><i class="iconfont reco-document"></i>
  Notes
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/wanyakun" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-4e82dffc data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>KVO实现原理</h3> <!----> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>wanyakun</span>
            
          <span data-v-4e82dffc>2016 - </span>
          2021
        </a></span></div></div> <div data-v-1156296a><main class="page"><section><div class="page-title"><h1 class="title">KVO实现原理</h1> <div data-v-1ff7123e><i class="iconfont reco-account" data-v-1ff7123e><span data-v-1ff7123e>wanyakun</span></i> <i class="iconfont reco-date" data-v-1ff7123e><span data-v-1ff7123e>11/11/2016</span></i> <!----> <i class="tags iconfont reco-tag" data-v-1ff7123e><span class="tag-item" data-v-1ff7123e>iOS</span></i></div></div> <div class="theme-reco-content content__default"><p><a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html" target="_blank" rel="noopener noreferrer">KVO<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和Notification是Objective-C语言中<a href="https://zh.wikipedia.org/wiki/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F" target="_blank" rel="noopener noreferrer">观察者模式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>的两种实现机制。KVO指定一个被观察对象，当被观察对象某个属性发生改变时，观察对象会获得通知，你不需要给被观察的对象添加任何额外代码。</p> <h3 id="一、什么是kvo"><a href="#一、什么是kvo" class="header-anchor">#</a> 一、什么是KVO</h3> <p><a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html" target="_blank" rel="noopener noreferrer">KVO<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和Notification是Objective-C语言中<a href="https://zh.wikipedia.org/wiki/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F" target="_blank" rel="noopener noreferrer">观察者模式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>的两种实现机制。KVO指定一个被观察对象，当被观察对象某个属性发生改变时，观察对象会获得通知，你不需要给被观察的对象添加任何额外代码。</p> <blockquote><p>KVO和Notification区别：KVO是被观察者直接发送消息给观察者，是对象间的交互，而Notification则是观察者和被观察者通过通知中心对象之间进行交互，即消息由被观察者发送到通知中心对象，再由中心对象发给观察者，两者之间并不进行直接的交互。</p></blockquote> <h3 id="二、实现原理"><a href="#二、实现原理" class="header-anchor">#</a> 二、实现原理</h3> <p>Apple官方文档描述：</p> <blockquote><h3 id="key-value-observing-implementation-details"><a href="#key-value-observing-implementation-details" class="header-anchor">#</a> Key-Value Observing Implementation Details</h3> <p>Automatic key-value observing is implemented using a technique called <em>isa-swizzling</em>.</p> <p>The <code>isa</code> pointer, as the name suggests, points to the object's class which maintains a dispatch table. This dispatch table essentially contains pointers to the methods the class implements, among other data.</p> <p>When an observer is registered for an attribute of an object the isa pointer of the observed object is modified, pointing to an intermediate class rather than at the true class. As a result the value of the isa pointer does not necessarily reflect the actual class of the instance.</p> <p>You should never rely on the <code>isa</code> pointer to determine class membership. Instead, you should use the <code>class</code> method to determine the class of an object instance.</p></blockquote> <p>从文档中可以看出KVO是通过一项叫做isa-swizzling技术来实现的。当为被观察者属性注册观察者时，被观察者的isa指针被修改，指向一个中间类，而不是真正的类。所以isa指针其实不需要指向实例对象真实的类。我们不要依赖isa指针来确定类成员，相反应该使用类方法来确定实例对象的类。</p> <p>从网上查到总结如下内容：</p> <p>当观察某对象时，KVO机制动态创建一个被观察对象类的子类，并为这个新的子类重写了被观察属性keyPath的setter 方法。setter 方法随后负责通知观察对象属性的改变状况。</p> <h3 id="三、使用举例"><a href="#三、使用举例" class="header-anchor">#</a> 三、使用举例</h3> <p>使用KVO分三步：</p> <ul><li><p>注册观察者:</p> <div class="language-objc line-numbers-mode"><pre class="language-objc"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>addObserver<span class="token punctuation">:</span><span class="token punctuation">(</span>NSObject <span class="token operator">*</span><span class="token punctuation">)</span>observer forKeyPath<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>keyPath options<span class="token punctuation">:</span><span class="token punctuation">(</span>NSKeyValueObservingOptions<span class="token punctuation">)</span>options context<span class="token punctuation">:</span><span class="token punctuation">(</span>nullable <span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span>context<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>观察者中实现</p> <div class="language-objc line-numbers-mode"><pre class="language-objc"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>observeValueForKeyPath<span class="token punctuation">:</span><span class="token punctuation">(</span>nullable NSString <span class="token operator">*</span><span class="token punctuation">)</span>keyPath ofObject<span class="token punctuation">:</span><span class="token punctuation">(</span>nullable id<span class="token punctuation">)</span>object change<span class="token punctuation">:</span><span class="token punctuation">(</span>nullable NSDictionary<span class="token operator">&lt;</span>NSKeyValueChangeKey<span class="token punctuation">,</span> id<span class="token operator">&gt;</span> <span class="token operator">*</span><span class="token punctuation">)</span>change context<span class="token punctuation">:</span><span class="token punctuation">(</span>nullable <span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span>context<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>移除观察者</p> <div class="language-objc line-numbers-mode"><pre class="language-objc"><code><span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>removeObserver<span class="token punctuation">:</span><span class="token punctuation">(</span>NSObject <span class="token operator">*</span><span class="token punctuation">)</span>observer forKeyPath<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>keyPath context<span class="token punctuation">:</span><span class="token punctuation">(</span>nullable <span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span>context <span class="token function">NS_AVAILABLE</span><span class="token punctuation">(</span><span class="token number">10</span>_7<span class="token punctuation">,</span> <span class="token number">5</span>_0<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>removeObserver<span class="token punctuation">:</span><span class="token punctuation">(</span>NSObject <span class="token operator">*</span><span class="token punctuation">)</span>observer forKeyPath<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>keyPath<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul> <p>从以上三步可以看出，使用KVO，不需要对被观察者对象做任何修改。</p> <ol><li><p>创建一个YKNoteKVOObject类，用于对它属性进行监听</p> <div class="language-objc line-numbers-mode"><pre class="language-objc"><code><span class="token comment">//</span>
<span class="token comment">//  YKNoteKVOObject.h</span>
<span class="token comment">//  YKNote</span>
<span class="token comment">//</span>
<span class="token comment">//  Created by wanyakun on 2016/11/3.</span>
<span class="token comment">//  Copyright © 2016年 com.ucaiyuan. All rights reserved.</span>
<span class="token comment">//</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">import</span> <span class="token expression"><span class="token operator">&lt;</span>Foundation<span class="token operator">/</span>Foundation<span class="token punctuation">.</span>h<span class="token operator">&gt;</span></span></span>

<span class="token keyword">@interface</span> YKNoteKVOObject <span class="token punctuation">:</span> NSObject

<span class="token keyword">@property</span> <span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span> copy<span class="token punctuation">)</span> NSString <span class="token operator">*</span>name<span class="token punctuation">;</span>

<span class="token keyword">@property</span> <span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span> assign<span class="token punctuation">)</span> NSInteger age<span class="token punctuation">;</span>

<span class="token keyword">@property</span> <span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span> assign<span class="token punctuation">)</span> CGFloat salary<span class="token punctuation">;</span>

<span class="token keyword">@property</span> <span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span> strong<span class="token punctuation">)</span> NSMutableArray <span class="token operator">*</span>friends<span class="token punctuation">;</span>

<span class="token keyword">@end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div></li> <li><p>创建一个Controller，添加监听，并打印</p> <div class="language-objc line-numbers-mode"><pre class="language-objc"><code><span class="token comment">//</span>
<span class="token comment">//  YKNoteKVOViewController.m</span>
<span class="token comment">//  YKNote</span>
<span class="token comment">//</span>
<span class="token comment">//  Created by wanyakun on 2016/11/7.</span>
<span class="token comment">//  Copyright © 2016年 com.ucaiyuan. All rights reserved.</span>
<span class="token comment">//</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">import</span> <span class="token string">&quot;YKNoteKVOViewController.h&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">import</span> <span class="token string">&quot;YKNoteKVOObject.h&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">import</span> <span class="token string">&quot;YKNoteRuntimeUtils.h&quot;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">import</span> <span class="token expression"><span class="token operator">&lt;</span>objc<span class="token operator">/</span>runtime<span class="token punctuation">.</span>h<span class="token operator">&gt;</span></span></span>

<span class="token keyword">@interface</span> <span class="token function">YKNoteKVOViewController</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">@property</span> <span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span> strong<span class="token punctuation">)</span> YKNoteKVOObject <span class="token operator">*</span>yKNoteKVOObject<span class="token punctuation">;</span>
<span class="token keyword">@property</span> <span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span> strong<span class="token punctuation">)</span> YKNoteKVOObject <span class="token operator">*</span>yKNoteKVOObject2<span class="token punctuation">;</span>
<span class="token keyword">@property</span> <span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span> strong<span class="token punctuation">)</span> YKNoteKVOObject <span class="token operator">*</span>yKNoteKVOObject3<span class="token punctuation">;</span>
<span class="token keyword">@property</span> <span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span> strong<span class="token punctuation">)</span> YKNoteKVOObject <span class="token operator">*</span>yKNoteKVOObject4<span class="token punctuation">;</span>

<span class="token keyword">@property</span> <span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span> strong<span class="token punctuation">)</span> UITextView <span class="token operator">*</span>textView<span class="token punctuation">;</span>

<span class="token keyword">@end</span>

<span class="token keyword">@implementation</span> YKNoteKVOViewController

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>viewDidLoad <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token keyword">super</span> viewDidLoad<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// Do any additional setup after loading the view.</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>view addSubview<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>textView fill<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">@&quot;YKNoteKVOObject&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject2<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">@&quot;YKNoteKVOObject2&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject3<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">@&quot;YKNoteKVOObject3&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject4<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">@&quot;YKNoteKVOObject4&quot;</span><span class="token punctuation">;</span>
    
    <span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject<span class="token punctuation">.</span>friends <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>NSMutableArray alloc<span class="token punctuation">]</span> initWithCapacity<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">@&quot;========before add observer objective detail========\n&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span> addBeforDetailToTextView<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token punctuation">[</span><span class="token keyword">self</span> addObserver<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text stringByAppendingString<span class="token punctuation">:</span><span class="token string">@&quot;========after add observer objective detail========\n&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span> addAfterDetailToTextView<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    
    <span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text stringByAppendingString<span class="token punctuation">:</span><span class="token string">@&quot;============cls supeCls============\n&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span> addClsSuperClsToTextView<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text stringByAppendingString<span class="token punctuation">:</span><span class="token string">@&quot;============Object IMP============\n&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span> addObjectIMPToTextView<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text stringByAppendingString<span class="token punctuation">:</span><span class="token string">@&quot;============Runtime IMP============\n&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span> addRuntimeMethodIMPToTextView<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text stringByAppendingString<span class="token punctuation">:</span><span class="token string">@&quot;============Observer change============\n&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//自动触发KVO通知</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">@&quot;YKNoteKVOObject Change property&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject setValue<span class="token punctuation">:</span><span class="token string">@&quot;YKNoteKVOObject setValue:forKey:&quot;</span> forKey<span class="token punctuation">:</span><span class="token string">@&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject setValue<span class="token punctuation">:</span><span class="token string">@&quot;YKNoteKVOObject setValue:forKeyPath:&quot;</span> forKeyPath<span class="token punctuation">:</span><span class="token string">@&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    NSMutableArray <span class="token operator">*</span>array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject mutableArrayValueForKey<span class="token punctuation">:</span><span class="token string">@&quot;friends&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>array addObject<span class="token punctuation">:</span><span class="token string">@&quot;wanyakun&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//手动触发KVO通知</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject<span class="token punctuation">.</span>salary <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>didReceiveMemoryWarning <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token keyword">super</span> didReceiveMemoryWarning<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// Dispose of any resources that can be recreated.</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>dealloc <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span> removeObserver<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject <span class="token operator">=</span> nil<span class="token punctuation">;</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject2 <span class="token operator">=</span> nil<span class="token punctuation">;</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject3 <span class="token operator">=</span> nil<span class="token punctuation">;</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject4 <span class="token operator">=</span> nil<span class="token punctuation">;</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>textView <span class="token operator">=</span> nil<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">mark <span class="token operator">-</span> private method</span></span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>addObserver <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject addObserver<span class="token punctuation">:</span><span class="token keyword">self</span> forKeyPath<span class="token punctuation">:</span><span class="token string">@&quot;name&quot;</span> options<span class="token punctuation">:</span>NSKeyValueObservingOptionNew<span class="token operator">|</span>NSKeyValueObservingOptionOld context<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject2 addObserver<span class="token punctuation">:</span><span class="token keyword">self</span> forKeyPath<span class="token punctuation">:</span><span class="token string">@&quot;age&quot;</span> options<span class="token punctuation">:</span>NSKeyValueObservingOptionNew<span class="token operator">|</span>NSKeyValueObservingOptionOld context<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject3 addObserver<span class="token punctuation">:</span><span class="token keyword">self</span> forKeyPath<span class="token punctuation">:</span><span class="token string">@&quot;name&quot;</span> options<span class="token punctuation">:</span>NSKeyValueObservingOptionNew<span class="token operator">|</span>NSKeyValueObservingOptionOld context<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject3 addObserver<span class="token punctuation">:</span><span class="token keyword">self</span> forKeyPath<span class="token punctuation">:</span><span class="token string">@&quot;age&quot;</span> options<span class="token punctuation">:</span>NSKeyValueObservingOptionNew<span class="token operator">|</span>NSKeyValueObservingOptionOld context<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject addObserver<span class="token punctuation">:</span><span class="token keyword">self</span> forKeyPath<span class="token punctuation">:</span><span class="token string">@&quot;salary&quot;</span> options<span class="token punctuation">:</span>NSKeyValueObservingOptionNew<span class="token operator">|</span>NSKeyValueObservingOptionOld context<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject addObserver<span class="token punctuation">:</span><span class="token keyword">self</span> forKeyPath<span class="token punctuation">:</span><span class="token string">@&quot;friends&quot;</span> options<span class="token punctuation">:</span>NSKeyValueObservingOptionNew<span class="token operator">|</span>NSKeyValueObservingOptionOld context<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>removeObserver <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject removeObserver<span class="token punctuation">:</span><span class="token keyword">self</span> forKeyPath<span class="token punctuation">:</span><span class="token string">@&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject2 removeObserver<span class="token punctuation">:</span><span class="token keyword">self</span> forKeyPath<span class="token punctuation">:</span><span class="token string">@&quot;age&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject3 removeObserver<span class="token punctuation">:</span><span class="token keyword">self</span> forKeyPath<span class="token punctuation">:</span><span class="token string">@&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject3 removeObserver<span class="token punctuation">:</span><span class="token keyword">self</span> forKeyPath<span class="token punctuation">:</span><span class="token string">@&quot;age&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject removeObserver<span class="token punctuation">:</span><span class="token keyword">self</span> forKeyPath<span class="token punctuation">:</span><span class="token string">@&quot;salary&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject removeObserver<span class="token punctuation">:</span><span class="token keyword">self</span> forKeyPath<span class="token punctuation">:</span><span class="token string">@&quot;friends&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>addBeforDetailToTextView <span class="token punctuation">{</span>
    NSString <span class="token operator">*</span>beforeDetail <span class="token operator">=</span>  <span class="token punctuation">[</span>YKNoteRuntimeUtils descriptionDetailWithName<span class="token punctuation">:</span><span class="token string">@&quot;yKNoteKVOObject&quot;</span> objc<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject<span class="token punctuation">]</span><span class="token punctuation">;</span>
    NSString <span class="token operator">*</span>beforeDetail2 <span class="token operator">=</span> <span class="token punctuation">[</span>YKNoteRuntimeUtils descriptionDetailWithName<span class="token punctuation">:</span><span class="token string">@&quot;yKNoteKVOObject2&quot;</span> objc<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject2<span class="token punctuation">]</span><span class="token punctuation">;</span>
    NSString <span class="token operator">*</span>beforeDetail3 <span class="token operator">=</span> <span class="token punctuation">[</span>YKNoteRuntimeUtils descriptionDetailWithName<span class="token punctuation">:</span><span class="token string">@&quot;yKNoteKVOObject3&quot;</span> objc<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject3<span class="token punctuation">]</span><span class="token punctuation">;</span>
    NSString <span class="token operator">*</span>beforeDetail4 <span class="token operator">=</span> <span class="token punctuation">[</span>YKNoteRuntimeUtils descriptionDetailWithName<span class="token punctuation">:</span><span class="token string">@&quot;yKNoteKVOObject4&quot;</span> objc<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject4<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text stringByAppendingString<span class="token punctuation">:</span><span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;%@%@%@%@&quot;</span><span class="token punctuation">,</span> beforeDetail<span class="token punctuation">,</span> beforeDetail2<span class="token punctuation">,</span> beforeDetail3<span class="token punctuation">,</span> beforeDetail4<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>addAfterDetailToTextView <span class="token punctuation">{</span>
    NSString <span class="token operator">*</span>afterDetail <span class="token operator">=</span>  <span class="token punctuation">[</span>YKNoteRuntimeUtils descriptionDetailWithName<span class="token punctuation">:</span><span class="token string">@&quot;yKNoteKVOObject&quot;</span> objc<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject<span class="token punctuation">]</span><span class="token punctuation">;</span>
    NSString <span class="token operator">*</span>afterDetail2 <span class="token operator">=</span> <span class="token punctuation">[</span>YKNoteRuntimeUtils descriptionDetailWithName<span class="token punctuation">:</span><span class="token string">@&quot;yKNoteKVOObject2&quot;</span> objc<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject2<span class="token punctuation">]</span><span class="token punctuation">;</span>
    NSString <span class="token operator">*</span>afterDetail3 <span class="token operator">=</span> <span class="token punctuation">[</span>YKNoteRuntimeUtils descriptionDetailWithName<span class="token punctuation">:</span><span class="token string">@&quot;yKNoteKVOObject3&quot;</span> objc<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject3<span class="token punctuation">]</span><span class="token punctuation">;</span>
    NSString <span class="token operator">*</span>afterDetail4 <span class="token operator">=</span> <span class="token punctuation">[</span>YKNoteRuntimeUtils descriptionDetailWithName<span class="token punctuation">:</span><span class="token string">@&quot;yKNoteKVOObject4&quot;</span> objc<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject4<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text stringByAppendingString<span class="token punctuation">:</span><span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;%@%@%@%@&quot;</span><span class="token punctuation">,</span> afterDetail<span class="token punctuation">,</span> afterDetail2<span class="token punctuation">,</span> afterDetail3<span class="token punctuation">,</span> afterDetail4<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>addClsSuperClsToTextView <span class="token punctuation">{</span>
    Class cls <span class="token operator">=</span> <span class="token function">object_getClass</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Class superCls <span class="token operator">=</span> <span class="token function">class_getSuperclass</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text stringByAppendingString<span class="token punctuation">:</span><span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;yKNoteKVOObject isa:%@\nyKNoteKVOObject isa's super class:%@\n&quot;</span><span class="token punctuation">,</span> cls<span class="token punctuation">,</span> superCls<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>addObjectIMPToTextView <span class="token punctuation">{</span>
    NSString <span class="token operator">*</span>objcIMP <span class="token operator">=</span> <span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;objcIMP yKNoteKVOObject setName:%p, setAge:%p\n&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject methodForSelector<span class="token punctuation">:</span><span class="token keyword">@selector</span><span class="token punctuation">(</span>setName<span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject methodForSelector<span class="token punctuation">:</span><span class="token keyword">@selector</span><span class="token punctuation">(</span>setAge<span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    NSString <span class="token operator">*</span>objcIMP2 <span class="token operator">=</span> <span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;objcIMP yKNoteKVOObject2 setName:%p, setAge:%p\n&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject2 methodForSelector<span class="token punctuation">:</span><span class="token keyword">@selector</span><span class="token punctuation">(</span>setName<span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject2 methodForSelector<span class="token punctuation">:</span><span class="token keyword">@selector</span><span class="token punctuation">(</span>setAge<span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    NSString <span class="token operator">*</span>objcIMP3 <span class="token operator">=</span> <span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;objcIMP yKNoteKVOObject3 setName:%p, setAge:%p\n&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject3 methodForSelector<span class="token punctuation">:</span><span class="token keyword">@selector</span><span class="token punctuation">(</span>setName<span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject3 methodForSelector<span class="token punctuation">:</span><span class="token keyword">@selector</span><span class="token punctuation">(</span>setAge<span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    NSString <span class="token operator">*</span>objcIMP4 <span class="token operator">=</span> <span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;objcIMP yKNoteKVOObject4 setName:%p, setAge:%p\n&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject4 methodForSelector<span class="token punctuation">:</span><span class="token keyword">@selector</span><span class="token punctuation">(</span>setName<span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject4 methodForSelector<span class="token punctuation">:</span><span class="token keyword">@selector</span><span class="token punctuation">(</span>setAge<span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text stringByAppendingString<span class="token punctuation">:</span><span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;%@%@%@%@&quot;</span><span class="token punctuation">,</span> objcIMP<span class="token punctuation">,</span> objcIMP2<span class="token punctuation">,</span> objcIMP3<span class="token punctuation">,</span> objcIMP4<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>addRuntimeMethodIMPToTextView <span class="token punctuation">{</span>
    NSString <span class="token operator">*</span>runtimeMethodImpl <span class="token operator">=</span> <span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;runtimeMethodImpl yKNoteKVOObject setName:%p, setAge:%p\n&quot;</span><span class="token punctuation">,</span> <span class="token function">class_getMethodImplementation</span><span class="token punctuation">(</span><span class="token function">object_getClass</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">@selector</span><span class="token punctuation">(</span>setName<span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">class_getMethodImplementation</span><span class="token punctuation">(</span><span class="token function">object_getClass</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">@selector</span><span class="token punctuation">(</span>setAge<span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    NSString <span class="token operator">*</span>runtimeMethodImpl2 <span class="token operator">=</span> <span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;runtimeMethodImpl yKNoteKVOObject2 setName:%p, setAge:%p\n&quot;</span><span class="token punctuation">,</span> <span class="token function">class_getMethodImplementation</span><span class="token punctuation">(</span><span class="token function">object_getClass</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">@selector</span><span class="token punctuation">(</span>setName<span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">class_getMethodImplementation</span><span class="token punctuation">(</span><span class="token function">object_getClass</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">@selector</span><span class="token punctuation">(</span>setAge<span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    NSString <span class="token operator">*</span>runtimeMethodImpl3 <span class="token operator">=</span> <span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;runtimeMethodImpl yKNoteKVOObject3 setName:%p, setAge:%p\n&quot;</span><span class="token punctuation">,</span> <span class="token function">class_getMethodImplementation</span><span class="token punctuation">(</span><span class="token function">object_getClass</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject3<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">@selector</span><span class="token punctuation">(</span>setName<span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">class_getMethodImplementation</span><span class="token punctuation">(</span><span class="token function">object_getClass</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject3<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">@selector</span><span class="token punctuation">(</span>setAge<span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    NSString <span class="token operator">*</span>runtimeMethodImpl4 <span class="token operator">=</span> <span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;runtimeMethodImpl yKNoteKVOObject4 setName:%p, setAge:%p\n&quot;</span><span class="token punctuation">,</span> <span class="token function">class_getMethodImplementation</span><span class="token punctuation">(</span><span class="token function">object_getClass</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject4<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">@selector</span><span class="token punctuation">(</span>setName<span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">class_getMethodImplementation</span><span class="token punctuation">(</span><span class="token function">object_getClass</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject4<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">@selector</span><span class="token punctuation">(</span>setAge<span class="token punctuation">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text stringByAppendingString<span class="token punctuation">:</span><span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;%@%@%@%@&quot;</span><span class="token punctuation">,</span> runtimeMethodImpl<span class="token punctuation">,</span> runtimeMethodImpl2<span class="token punctuation">,</span> runtimeMethodImpl3<span class="token punctuation">,</span> runtimeMethodImpl4<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>observeValueForKeyPath<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>keyPath ofObject<span class="token punctuation">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>object change<span class="token punctuation">:</span><span class="token punctuation">(</span>NSDictionary<span class="token operator">&lt;</span>NSKeyValueChangeKey<span class="token punctuation">,</span>id<span class="token operator">&gt;</span> <span class="token operator">*</span><span class="token punctuation">)</span>change context<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">)</span>context <span class="token punctuation">{</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>textView<span class="token punctuation">.</span>text stringByAppendingString<span class="token punctuation">:</span><span class="token punctuation">[</span>NSString stringWithFormat<span class="token punctuation">:</span><span class="token string">@&quot;The value of %@ change to : %@\n&quot;</span><span class="token punctuation">,</span>keyPath<span class="token punctuation">,</span> <span class="token punctuation">[</span>change objectForKey<span class="token punctuation">:</span><span class="token string">@&quot;new&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;The value of %@ change to : %@\n&quot;</span><span class="token punctuation">,</span> keyPath<span class="token punctuation">,</span> <span class="token punctuation">[</span>change objectForKey<span class="token punctuation">:</span><span class="token string">@&quot;new&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">mark <span class="token operator">-</span> getter</span></span>
<span class="token operator">-</span> <span class="token punctuation">(</span>YKNoteKVOObject <span class="token operator">*</span><span class="token punctuation">)</span>yKNoteKVOObject <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_yKNoteKVOObject <span class="token operator">==</span> nil<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        _yKNoteKVOObject <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>YKNoteKVOObject alloc<span class="token punctuation">]</span> init<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> _yKNoteKVOObject<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span>YKNoteKVOObject <span class="token operator">*</span><span class="token punctuation">)</span>yKNoteKVOObject2 <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_yKNoteKVOObject2 <span class="token operator">==</span> nil<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        _yKNoteKVOObject2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>YKNoteKVOObject alloc<span class="token punctuation">]</span> init<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> _yKNoteKVOObject2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span>YKNoteKVOObject <span class="token operator">*</span><span class="token punctuation">)</span>yKNoteKVOObject3 <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_yKNoteKVOObject3 <span class="token operator">==</span> nil<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        _yKNoteKVOObject3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>YKNoteKVOObject alloc<span class="token punctuation">]</span> init<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> _yKNoteKVOObject3<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span>YKNoteKVOObject <span class="token operator">*</span><span class="token punctuation">)</span>yKNoteKVOObject4 <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_yKNoteKVOObject4 <span class="token operator">==</span> nil<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        _yKNoteKVOObject4 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>YKNoteKVOObject alloc<span class="token punctuation">]</span> init<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> _yKNoteKVOObject4<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span>UITextView <span class="token operator">*</span><span class="token punctuation">)</span>textView <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_textView <span class="token operator">==</span> nil<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        _textView <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>UITextView alloc<span class="token punctuation">]</span> init<span class="token punctuation">]</span><span class="token punctuation">;</span>
        _textView<span class="token punctuation">.</span>contentOffset <span class="token operator">=</span> <span class="token function">CGPointMake</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        _textView<span class="token punctuation">.</span>editable <span class="token operator">=</span> NO<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> _textView<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">@end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br></div></div></li> <li><p>输出的内容</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>   <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>before <span class="token function">add</span> observer objective <span class="token assign-left variable">detail</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
   yKNoteKVOObject:<span class="token operator">&lt;</span>YKNoteKVOObject: 0x60800024edf<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
   	class YKNoteKVOObject
   	objcClass YKNoteKVOObject
   	implementmethod 
   		setFriends:,
   		setSalary:,
   		setAge:,
   		age,
   		salary,
   		friends,
   		subObject,
   		setSubObject:,
   		.cxx_destruct,
   		name,
   		setName:,
   		init
   yKNoteKVOObject2:<span class="token operator">&lt;</span>YKNoteKVOObject: 0x60800024eee<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
   	class YKNoteKVOObject
   	objcClass YKNoteKVOObject
   	implementmethod 
   		setFriends:,
   		setSalary:,
   		setAge:,
   		age,
   		salary,
   		friends,
   		subObject,
   		setSubObject:,
   		.cxx_destruct,
   		name,
   		setName:,
   		init
   yKNoteKVOObject3:<span class="token operator">&lt;</span>YKNoteKVOObject: 0x60800005bc3<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
   	class YKNoteKVOObject
   	objcClass YKNoteKVOObject
   	implementmethod 
   		setFriends:,
   		setSalary:,
   		setAge:,
   		age,
   		salary,
   		friends,
   		subObject,
   		setSubObject:,
   		.cxx_destruct,
   		name,
   		setName:,
   		init
   yKNoteKVOObject4:<span class="token operator">&lt;</span>YKNoteKVOObject: 0x60800024e0d<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
   	class YKNoteKVOObject
   	objcClass YKNoteKVOObject
   	implementmethod 
   		setFriends:,
   		setSalary:,
   		setAge:,
   		age,
   		salary,
   		friends,
   		subObject,
   		setSubObject:,
   		.cxx_destruct,
   		name,
   		setName:,
   		init
   <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>after <span class="token function">add</span> observer objective <span class="token assign-left variable">detail</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
   yKNoteKVOObject:<span class="token operator">&lt;</span>YKNoteKVOObject: 0x60800024edf<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
   	class YKNoteKVOObject
   	objcClass NSKVONotifying_YKNoteKVOObject
   	implementmethod 
   		setFriends:,
   		setAge:,
   		setName:,
   		class,
   		dealloc,
   		_isKVOA
   yKNoteKVOObject2:<span class="token operator">&lt;</span>YKNoteKVOObject: 0x60800024eee<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
   	class YKNoteKVOObject
   	objcClass NSKVONotifying_YKNoteKVOObject
   	implementmethod 
   		setFriends:,
   		setAge:,
   		setName:,
   		class,
   		dealloc,
   		_isKVOA
   yKNoteKVOObject3:<span class="token operator">&lt;</span>YKNoteKVOObject: 0x60800005bc3<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
   	class YKNoteKVOObject
   	objcClass NSKVONotifying_YKNoteKVOObject
   	implementmethod 
   		setFriends:,
   		setAge:,
   		setName:,
   		class,
   		dealloc,
   		_isKVOA
   yKNoteKVOObject4:<span class="token operator">&lt;</span>YKNoteKVOObject: 0x60800024e0d<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
   	class YKNoteKVOObject
   	objcClass YKNoteKVOObject
   	implementmethod 
   		setFriends:,
   		setSalary:,
   		setAge:,
   		age,
   		salary,
   		friends,
   		subObject,
   		setSubObject:,
   		.cxx_destruct,
   		name,
   		setName:,
   		init
   <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>cls <span class="token assign-left variable">supeCls</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
   yKNoteKVOObject isa:NSKVONotifying_YKNoteKVOObject
   yKNoteKVOObject isa's super class:YKNoteKVOObject
   <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>Object <span class="token assign-left variable">IMP</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
   objcIMP yKNoteKVOObject setName:0x1004c145d, setAge:0x1004c7c16
   objcIMP yKNoteKVOObject2 setName:0x1004c145d, setAge:0x1004c7c16
   objcIMP yKNoteKVOObject3 setName:0x1004c145d, setAge:0x1004c7c16
   objcIMP yKNoteKVOObject4 setName:0x1003af810, setAge:0x1003af870
   <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>Runtime <span class="token assign-left variable">IMP</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
   runtimeMethodImpl yKNoteKVOObject setName:0x1004c145d, setAge:0x1004c7c16
   runtimeMethodImpl yKNoteKVOObject2 setName:0x1004c145d, setAge:0x1004c7c16
   runtimeMethodImpl yKNoteKVOObject3 setName:0x1004c145d, setAge:0x1004c7c16
   runtimeMethodImpl yKNoteKVOObject4 setName:0x1003af810, setAge:0x1003af870
   <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>Observer <span class="token assign-left variable">change</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
   The value of name change to <span class="token builtin class-name">:</span> YKNoteKVOObject Change property
   The value of name change to <span class="token builtin class-name">:</span> YKNoteKVOObject setValue:forKey:
   The value of name change to <span class="token builtin class-name">:</span> YKNoteKVOObject setValue:forKeyPath:
   The value of friends change to <span class="token builtin class-name">:</span> <span class="token punctuation">(</span>
       wanyakun
   <span class="token punctuation">)</span>
   The value of salary change to <span class="token builtin class-name">:</span> <span class="token number">1000</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br></div></div><p>从输出能容可以得出：</p> <blockquote><p>class = [objc class],</p> <p>objcClass = object_getClass(objc)</p> <div class="language-objc line-numbers-mode"><pre class="language-objc"><code>Class <span class="token function">object_getClass</span><span class="token punctuation">(</span>id obj<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token keyword">return</span> obj<span class="token operator">-&gt;</span><span class="token function">getIsa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span> Nil<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></blockquote></li></ol> <ul><li>添加observer之前，所有对象的class和objcClass均为YKNoteKVOObject。</li> <li>添加observer之后，添加了observer的对象的class为YKNoteKVOObject， objecClass为NSKVONotifying_YKNoteKVOObject
<ul><li>添加observer之后，对象的isa指针已经被替换为NSKVONotifying_YKNoteKVOObject，为YKNoteKVOObject子类，即动态生成子类（在原类添加前缀NSKVONotifying_），并使用子类替换对象的isa指针。</li> <li>子类NSKVONotifying_YKNoteKVOObject重载了被添加了observer的属性的set方法。</li></ul></li></ul> <h3 id="四、kvo-compliance"><a href="#四、kvo-compliance" class="header-anchor">#</a> 四、KVO Compliance</h3> <p>官方文档：https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/KeyValueObserving/Articles/KVOCompliance.html#//apple_ref/doc/uid/20002178-SW3</p> <p>其中涉及到到两种技术：自动发射key-value change通知和手动发射key-value change通知</p> <ul><li><p>自动发射key-value change通知</p> <p>NSObject实现了自动发射key-value change通知，使用存取器、KVC方法都会自动发射变化通知，对于集合属性，可以通过代理对象来达到自动发射变化通知。</p> <div class="language-objc line-numbers-mode"><pre class="language-objc"><code><span class="token comment">// Call the accessor method.</span>
<span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">@&quot;YKNoteKVOObject Change property&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// Use setValue:forKey:</span>
<span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject setValue<span class="token punctuation">:</span><span class="token string">@&quot;YKNoteKVOObject setValue:forKey:&quot;</span> forKey<span class="token punctuation">:</span><span class="token string">@&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// Use a key path, where 'yKNoteKVOObject' is a kvc-compliant property of 'name'.</span>
<span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject setValue<span class="token punctuation">:</span><span class="token string">@&quot;YKNoteKVOObject setValue:forKeyPath:&quot;</span> forKeyPath<span class="token punctuation">:</span><span class="token string">@&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// Use mutableArrayValueForKey: to retrieve a relationship proxy object</span>
NSMutableArray <span class="token operator">*</span>array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>yKNoteKVOObject mutableArrayValueForKey<span class="token punctuation">:</span><span class="token string">@&quot;friends&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>array addObject<span class="token punctuation">:</span><span class="token string">@&quot;wanyakun&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>手动发射key-value change通知</p> <p>手动发射key-value change通知需要实现automaticallyNotifiesObserversForKey:方法。</p> <div class="language-objc line-numbers-mode"><pre class="language-objc"><code><span class="token comment">/*
 手动实现KVO发射通知，需要重载automaticallyNotifiesObserversForKey:,或者实现automaticallyNotifiesObserversOf&lt;key&gt;, 对于不需要自动发射KVO通知的属性需要返回NO，然后在setter方法中添加willChangeValueForKey:和didChangeValueForKey:方法的调用代码
 */</span>
<span class="token operator">+</span> <span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>automaticallyNotifiesObserversOfSalary <span class="token punctuation">{</span>
    <span class="token keyword">return</span> NO<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">+</span> <span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>automaticallyNotifiesObserversForKey<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>key <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>key isEqualToString<span class="token punctuation">:</span><span class="token string">@&quot;salary&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> NO<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token keyword">super</span> automaticallyNotifiesObserversForKey<span class="token punctuation">:</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>setSalary<span class="token punctuation">:</span><span class="token punctuation">(</span>CGFloat<span class="token punctuation">)</span>salary <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span> willChangeValueForKey<span class="token punctuation">:</span><span class="token string">@&quot;salary&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    _salary <span class="token operator">=</span> salary<span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span> didChangeValueForKey<span class="token punctuation">:</span><span class="token string">@&quot;salary&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li></ul> <h3 id="五、总结"><a href="#五、总结" class="header-anchor">#</a> 五、总结</h3> <p>使用Clang对addObserver代码进行编译，对编译结果代码查看，其中并无NSKVONotifying_YKNoteKVOObject任何代码。更说明，NSKVONotifying_YKNoteKVOObject子类是在runtime时动态生成的。由于这种继承方式的注入是在运行时而不是编译时实现的，如果给定的实例没有观察者，那么KVO不会有任何开销。</p></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">5/19/2021, 11:39:42 AM</span></div></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-70334359><li class="level-3" data-v-70334359><a href="/blogs/code/2016/2016-11-11-kvo-principle-of-realization.html#一、什么是kvo" class="sidebar-link reco-side-一、什么是kvo" data-v-70334359>一、什么是KVO</a></li><li class="level-3" data-v-70334359><a href="/blogs/code/2016/2016-11-11-kvo-principle-of-realization.html#二、实现原理" class="sidebar-link reco-side-二、实现原理" data-v-70334359>二、实现原理</a></li><li class="level-3" data-v-70334359><a href="/blogs/code/2016/2016-11-11-kvo-principle-of-realization.html#key-value-observing-implementation-details" class="sidebar-link reco-side-key-value-observing-implementation-details" data-v-70334359>Key-Value Observing Implementation Details</a></li><li class="level-3" data-v-70334359><a href="/blogs/code/2016/2016-11-11-kvo-principle-of-realization.html#三、使用举例" class="sidebar-link reco-side-三、使用举例" data-v-70334359>三、使用举例</a></li><li class="level-3" data-v-70334359><a href="/blogs/code/2016/2016-11-11-kvo-principle-of-realization.html#四、kvo-compliance" class="sidebar-link reco-side-四、kvo-compliance" data-v-70334359>四、KVO Compliance</a></li><li class="level-3" data-v-70334359><a href="/blogs/code/2016/2016-11-11-kvo-principle-of-realization.html#五、总结" class="sidebar-link reco-side-五、总结" data-v-70334359>五、总结</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><!----></div></div>
    <script src="/assets/js/app.84ca5ab8.js" defer></script><script src="/assets/js/3.45fd2d9d.js" defer></script><script src="/assets/js/1.5fe79815.js" defer></script><script src="/assets/js/26.acba0af1.js" defer></script><script src="/assets/js/8.f448fe9c.js" defer></script>
  </body>
</html>
