(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{674:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"现状"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#现状"}},[s._v("#")]),s._v(" 现状")]),s._v(" "),a("p",[s._v("app目前已经完成以下组件的接入。并持续对目前主工程中的基础类、通用业务类和业务类进拆分。当前大量业务还存在与主工程，主工程还暂时未形成壳工程，随着业务的拆分组件化，主工程中只剩下配置，则会形成真正的壳工程。目前暂将其视为携有业务的壳工程。")]),s._v(" "),a("p",[s._v("基础组件的接入包括：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("XXXBLUtils")])]),s._v(" "),a("li",[a("code",[s._v("XXXBLCore")])]),s._v(" "),a("li",[a("code",[s._v("XXXBLNetworking")])]),s._v(" "),a("li",[a("code",[s._v("XXXBLRouter")])]),s._v(" "),a("li",[a("code",[s._v("XXXBLWebViewJSBridge")])])]),s._v(" "),a("p",[s._v("通用业务组件的接入包括：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("XXXBIZTracker")])]),s._v(" "),a("li",[a("code",[s._v("XXXBIZCommon")])])]),s._v(" "),a("p",[s._v("业务组件的接入包括：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("XXXBIZFeedback")])]),s._v(" "),a("li",[a("code",[s._v("XXXBASEUICommon")])]),s._v(" "),a("li",[a("code",[s._v("XXXCharts")])]),s._v(" "),a("li",[a("code",[s._v("XXXHealthplan")])])]),s._v(" "),a("h2",{attrs:{id:"组件开发"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#组件开发"}},[s._v("#")]),s._v(" 组件开发")]),s._v(" "),a("p",[s._v("新业务要以组件的方式进行开发，推荐使用模板：https://github.com/wanyakun/pod-template.git 创建。（可替换为自己的模板）\n"),a("code",[s._v("pod lib create --template-url=https://github.com/wanyakun/pod-template.git MyLibrary")]),s._v(" 模板中包含fastlane的一些action，包括：生成动态Framework和发布组件（目前是源码发布，二进制化后优化进行Framework发布）")]),s._v(" "),a("p",[s._v("以下为登录组件的基本结构：")]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/img/2017/component-login.jpeg",alt:"login"}})]),s._v(" "),a("p",[s._v("随着App中公共资源的下沉，业务拆分会更容易进行，其依赖的公共资源只需要依赖下沉后的组件即可。业务开发可以根据情况采取MVC/MVVM/MVP进行开发。")]),s._v(" "),a("h2",{attrs:{id:"壳工程配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#壳工程配置"}},[s._v("#")]),s._v(" 壳工程配置")]),s._v(" "),a("p",[s._v("壳工程主要通过Podfile对依赖的组件进行版本配置。以下为App的Podfile内容：")]),s._v(" "),a("div",{staticClass:"language-ruby line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ruby"}},[a("code",[s._v("workspace "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'XXX.xcworkspace'")]),s._v("\nsource "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://git.xxx.com/xxx/Specs.git'")]),s._v("\nsource "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://github.com/CocoaPods/Specs.git'")]),s._v("\n\nplatform "),a("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":ios")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8.0"')]),s._v("\nuse_frameworks"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\ninhibit_all_warnings"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n\ntarget "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'XXX'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=====================================第三方组件=================================")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Masonry'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("                 "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'~> 1.0.2'")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'UMengUShare/UI'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'6.4.4'")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#U-Share SDK UI模块（分享面板，建议添加）")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'UMengUShare/Social/Sina'")]),s._v("             "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#集成新浪微博")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'UMengUShare/Social/WeChat'")]),s._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#集成微信")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'UMengUShare/Social/QQ'")]),s._v("               "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#集成QQ")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'SDWebImage'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("              "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'4.0.0'")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ZBarSDK'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("                 "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1.3.1'")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#二维码扫描")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tingyunApp'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("              "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2.5.7'")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'YYModel'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":podspec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://raw.githubusercontent.com/ibireme/YYModel/master/YYModel.podspec'")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'UICKeyChainStore'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":podspec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://raw.githubusercontent.com/kishikawakatsumi/UICKeyChainStore/master/UICKeyChainStore.podspec'")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'APIService-XGPush'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":podspec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://raw.githubusercontent.com/ElfSundae/AppComponents/master/APIService/APIService-XGPush.podspec'")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pop'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("                     "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'~> 1.0'")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'YXWaveView'")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#=====================================内部组件===================================")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'XXXCharts'")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'XXXBLRouter'")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'XXXBLWebViewJSBridge'")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'XXXBLNetworking'")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'XXXBIZCommon'")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'XXXBIZTracker'")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'XXXBASEUICommon'")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'XXXHealthplan'")]),s._v("\n    pod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'XXXBIZFeedback'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br")])]),a("p",[s._v("Podfile指定版本号逻辑：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("pod 'AFNetworking'")]),s._v(" 不指定版本")]),s._v(" "),a("li",[a("code",[s._v("pod 'AFNetworking', '1.0'")]),s._v("  版本号指定为1.0")]),s._v(" "),a("li",[a("code",[s._v("pod 'AFNetworking', '> 1.0'")]),s._v(" 1.0版本以上")]),s._v(" "),a("li",[a("code",[s._v("pod 'AFNetworking', '>= 1.0'")]),s._v(" 1.0版本以上，包括1.0")]),s._v(" "),a("li",[a("code",[s._v("pod 'AFNetworking', '< 1.0'")]),s._v(" 1.0版本以下")]),s._v(" "),a("li",[a("code",[s._v("pod 'AFNetworking', '<= 1.0'")]),s._v(" 1.0版本以下，包括1.0")]),s._v(" "),a("li",[a("code",[s._v("pod 'AFNetworking', '~> 1.0'")]),s._v(" 版本号可以是1.0，可以是1.1，1.9，但必须小于2")]),s._v(" "),a("li",[a("code",[s._v("pod 'AFNetworking', '~> 3.1.0'")]),s._v(" 版本3.2.0以下，不包括3.2.0，版本3.1.0以上，包括3.1.0")])]),s._v(" "),a("p",[s._v("所以我们的Podfile采取最后一种方式设置，也要求我们的组件安装major.minor.patch的方式设置版本。每次版本更新，在开发需求确定后就必须确定major、minor和patch，pod update只会升patch。")]),s._v(" "),a("h2",{attrs:{id:"版本开发流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#版本开发流程"}},[s._v("#")]),s._v(" 版本开发流程")]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/img/2017/shell-project-plan.jpg",alt:"壳工程实施方案"}})]),s._v(" "),a("h2",{attrs:{id:"jenkins自动打包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jenkins自动打包"}},[s._v("#")]),s._v(" Jenkins自动打包")]),s._v(" "),a("p",[s._v("在进入集成测试阶段，就需要使用Jenkins进行自动打包，Jenkins会自动从git上拉去壳工程，进行CocoaPods依赖获取组件，然后进行打包发布。")]),s._v(" "),a("h3",{attrs:{id:"现状-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#现状-2"}},[s._v("#")]),s._v(" 现状")]),s._v(" "),a("p",[s._v("目前很多业务还在主工程中进行开发，所以主工程会产生一些feature分支，然后进行merge，目前采用在release分支进行集成测试打包。")]),s._v(" "),a("h3",{attrs:{id:"组件化完成之后"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#组件化完成之后"}},[s._v("#")]),s._v(" 组件化完成之后")]),s._v(" "),a("p",[s._v("主工程只剩下壳，只剩下Podfile和极少的文件进行配置。壳工程不需要进行业务开发，所以推荐一个版本使用一个分支（也支持可以多版本同时进行），Jenkins上根据版本创建对应的Job")]),s._v(" "),a("p",[s._v("注：若不存在版本并行，也可以采用现有方式固定在release分支进行打包。")])])}),[],!1,null,null,null);t.default=e.exports}}]);