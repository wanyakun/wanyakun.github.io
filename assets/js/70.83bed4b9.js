(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{577:function(t,a,r){"use strict";r.r(a);var e=r(4),_=function(t){t.options.__data__block__={flowchart_382ee168:"st=>start: 用户提交域名\nop1=>operation: 浏览器对域\n名进行解释\nop2=>operation: DNS 解析得到目\n的主机的IP地址\nop3=>operation: 根据IP地址访\n问发出请求\nend=>end: 得到请求数\n据并回复\n\nst(right)->op1(right)->op2(right)->op3(right)->end",mermaid_382ee1ca:"graph LR\ntxt1(浏览器) -- 1. 发送域名 --\x3e txt2(DNS服务器加速域名CNAME) -- 2.域名解析工作 --\x3e txt3(CDN专用DNS服务器CNAME的IP列表) -- 3.返回IP地址 --\x3e txt1(浏览器)\ntxt1(浏览器) -- 4. 访问服务器 --\x3e txt4(CDN服务器)\n"}},n=Object(e.a)({},(function(){var t=this,a=t.$createElement,r=t._self._c||a;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h2",{attrs:{id:"cdn是什么"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#cdn是什么"}},[t._v("#")]),t._v(" CDN是什么")]),t._v(" "),r("p",[t._v("CDN (全称 Content Delivery Network)，即内容分发网络")]),t._v(" "),r("p",[t._v("构建在现有网络基础之上的智能虚拟网络，依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使用户就近获取所需内容，降低网络拥塞，提高用户访问响应速度和命中率。CDN 的关键技术主要有内容存储和分发技术")]),t._v(" "),r("p",[t._v("简单来讲，CDN就是根据用户位置分配最近的资源")]),t._v(" "),r("p",[t._v("于是，用户在上网的时候不用直接访问源站，而是访问离他“最近的”一个 CDN 节点，术语叫边缘节点，其实就是缓存了源站内容的代理服务器。如下图")]),t._v(" "),r("p",[r("img",{attrs:{src:"/assets/img/front/network/cdn.png",alt:"cdn"}})]),t._v(" "),r("h2",{attrs:{id:"实现原理"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#实现原理"}},[t._v("#")]),t._v(" 实现原理")]),t._v(" "),r("p",[t._v("在没有应用CDN时，我们使用域名访问某一个站点时的路径为")]),t._v(" "),r("FlowChart",{attrs:{id:"flowchart_382ee168",code:t.$dataBlock.flowchart_382ee168,preset:"vue"}}),r("p",[t._v("应用CDN后，DNS 返回的不再是 IP 地址，而是一个CNAME(Canonical Name ) 别名记录，指向CDN的全局负载均衡"),r("br"),t._v("\nCNAME实际上在域名解析的过程中承担了中间人（或者说代理）的角色，这是CDN实现的关键")]),t._v(" "),r("h3",{attrs:{id:"负载均衡系统"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#负载均衡系统"}},[t._v("#")]),t._v(" 负载均衡系统")]),t._v(" "),r("p",[t._v("由于没有返回IP地址，于是本地DNS会向负载均衡系统再发送请求 ，则进入到CDN的全局负载均衡系统进行智能调度：")]),t._v(" "),r("ul",[r("li",[t._v("看用户的 IP 地址，查表得知地理位置，找相对最近的边缘节点")]),t._v(" "),r("li",[t._v("看用户所在的运营商网络，找相同网络的边缘节点")]),t._v(" "),r("li",[t._v("检查边缘节点的负载情况，找负载较轻的节点")]),t._v(" "),r("li",[t._v("其他，比如节点的“健康状况”、服务能力、带宽、响应时间等")])]),t._v(" "),r("p",[t._v("结合上面的因素，得到最合适的边缘节点，然后把这个节点返回给用户，用户就能够就近访问CDN的缓存代理")]),t._v(" "),r("Mermaid",{attrs:{id:"mermaid_382ee1ca",graph:t.$dataBlock.mermaid_382ee1ca}}),r("h3",{attrs:{id:"缓存代理"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#缓存代理"}},[t._v("#")]),t._v(" 缓存代理")]),t._v(" "),r("p",[t._v("缓存系统是 CDN的另一个关键组成部分，缓存系统会有选择地缓存那些最常用的那些资源"),r("br"),t._v("\n其中有两个衡量CDN服务质量的指标：")]),t._v(" "),r("ul",[r("li",[t._v("命中率：用户访问的资源恰好在缓存系统里，可以直接返回给用户，命中次数与所有访问次数之比")]),t._v(" "),r("li",[t._v("回源率：缓存里没有，必须用代理的方式回源站取，回源次数与所有访问次数之比")])]),t._v(" "),r("p",[t._v("缓存系统也可以划分出层次，分成一级缓存节点和二级缓存节点。一级缓存配置高一些，直连源站，二级缓存配置低一些，直连用户"),r("br"),t._v("\n回源的时候二级缓存只找一级缓存，一级缓存没有才回源站，可以有效地减少真正的回源"),r("br"),t._v("\n现在的商业 CDN命中率都在 90% 以上，相当于把源站的服务能力放大了 10 倍以上")]),t._v(" "),r("h2",{attrs:{id:"总结"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),r("p",[t._v("CDN 目的是为了改善互联网的服务质量，通俗一点说其实就是提高访问速度"),r("br"),t._v("\nCDN 构建了全国、全球级别的专网，让用户就近访问专网里的边缘节点，降低了传输延迟，实现了网站加速"),r("br"),t._v("\n通过CDN的负载均衡系统，智能调度边缘节点提供服务，相当于CDN服务的大脑，而缓存系统相当于CDN的心脏，缓存命中直接返回给用户，否则回源")])],1)}),[],!1,null,null,null);"function"==typeof _&&_(n);a.default=n.exports}}]);